<!DOCTYPE html>
<html ng-app>
<head>
    <titleVCV</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="fonts/stylesheet.css" type="text/css" charset="utf-8" />
    <link href="css/main.css" rel="stylesheet">
    <link href="css/main2.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/bootstrap-select.css">
    <link href="js/pnotify/jquery.pnotify.default.css" media="all" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery.ui.all.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
      <![endif]-->
  </head>
  <body ng-app="dashboardApp" ng-controller="postJob">
    <div class="spinner hide" id="overlay" ng-cloak ></div>
    <!----------------------------DASHBOARD Header---------------------------->
    <div class="mc-header clearfix" ng-show="isLogged">
        <div class="mc-logo">
            <a href="index.html"><img src="img/vcv.png"></a>
        </div>
        <div class="notification-borrower">
           <div class="media profileImage"> <!-- <a class="pull-left" href="#"> <img class="media-object" src="{{dashboardData.image}}" alt="..."> </a> -->
            <div class="media-body">
             <h4 class="media-heading">{{dashboardData.username}}</h4>
             <b class="caret"></b> </div>
         </div>
         <div class="quick-menu-dropdown">
            <ul>
            <!--  <li><a href="#"> <span class="qucik-menu profile-icon"></span> <span class="text-block"> <span class="head-text">Change Profile Picture</span> </span> </a> </li>
             <li><a href="#"> <span class="qucik-menu password-icon"></span> <span class="text-block"> <span class="head-text">Change Password</span> </span> </a> </li>
             <li><a href="#"> <span class="qucik-menu member-icon"></span> <span class="text-block"> <span class="head-text">Upgrade Membership</span> </span> </a> </li> -->
             <li ng-click="logout()"><a href="#"> <span class="qucik-menu member-icon"></span> <span class="text-block"> <span class="head-text">Logout</span> </span> </a> </li>
         </ul>
     </div>
 </div>
 <div class="single-dashboard">
    <a href="dashboard.html">DASHBOARD</a>
</div>
</div>

<div class="mc-header clearfix" ng-show="isNotLogged" ng-cloak>
  <div class="mc-logo"> <a href="index.html"><img src="img/vcv.png"></a> </div>
  <div class="sign-in">
    <ul>
      <li class="sign-in-drop"> <a class="menu" id="sign_in_click" href "#">SIGN IN</a>
        <div class="sign-in-dropdown">
          <form name="signInForm" id="sign-in-form">
            <span class="grey-caret"></span> 
            
            <!-- <a class="user-search" href="#">
                    <span class="sign-img"><img src="img/sigin-up-img.jpg"></span>
                    <h2>Michael Moore, Borrower</h2>
                </a> -->

                <label>Username/Email</label>
                <br clear="all">
                <span class="form-hold4 clearfix">
                    <div class="validate-line">
                      <input type="text" validate-type="email" required class="input-field" ng-model="signInData.username" name="username">
                      <div class="input-wrapper"></div>
                  </div>
              </span>
              <label class="signin-space">Password</label>
              <br clear="all">
              <span class="form-hold4 clearfix">
                <div class="validate-line">
                  <input type="password" validate-type="novalid" validate-on-blur required class="input-field" ng-model="signInData.login_password" name="login_password">
                  <div class="input-wrapper"></div>
              </div>
              <button class="mc-btn sign-in-dropdown-btn2" type="submit" ng-click="submitSignIn()">SIGN IN</button>
              <div class="pull-right pointer"><a data-toggle="modal" data-target="#forgotPasswordModal" href="#">Forgot your password?</a></div>
          </span>
      </form>
      <div class="social-signin"> <a id="facebook-link" href="social/facebook/borrower"><span class="social-sprite fb-icon transition"></span></a> <a id="google-link" href="social/google/borrower"><span class="social-sprite gplus-icon transition"></span></a> <a id="linkedin-link" href="social/linkedIn/borrower"><span class="social-sprite lin-icon transition"></span></a> </div>
  </div>
</li>
<li><a class="menu" href="aboutus.html">ABOUT US</a></li>
<li class="how-it-works"><a class="menu hw" href >HOW IT<br>
    WORKS</a>
</li>
</ul>
</div>
</div>

<form>
    <p class="info-para" style="margin-left: 20%">
      <span class="info-logo-icon sprite"></span>
      <span class="text">Welcome to Mortgage Chance,  you are required to enter your personal details in order in help us verify and rate your profile.  Mortgage Chance will <strong>never</strong> disclose any of your personal details to investors.  If you see a * next to a field, that item is and always will be confidential.</span>
    </p>
    <span class="main-form-headings">Post A Job</span>
    <div class="main-form"> 

      <!--Title-->
      <label>Job Type*</label>
      <br clear="all">
      <span class="form-hold2 clearfix">
        <div class="validate-line">
          <select class="input-field" ng-model="sendingData.job_type" >
            <option checked value="permanent">Permanent</option>
            <option value="contract">Contract</option>
          </select>
          <div class="input-wrapper"></div>
          <div class="message"></div>
        </div>
      </span> <br clear="all">

      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Job Industry</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.job_industry" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>

      <!--First Name-->
      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Job Description</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="">
              <textarea type="text" required ng-model="sendingData.job_description" validate-type="name" class="input-field " name="job_description"></textarea>
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>

      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Job Designation</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.job_designation" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>


       <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Min Experience</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.min_exp_level" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>

      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Max Experience</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.max_exp_level" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>

      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Min Salary</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.min_salary_range" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>


      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Max Salary</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.max_salary_range" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>


      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Company Name</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.company_name" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>


      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Link To Company</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.link_to_compnay" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>


      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Company Logo (Link)</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="validate-line ">
              <input type="text" ng-model="sendingData.company_logo" class="input-field" >
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>


      <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Company Description</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="">
              <textarea type="text" required ng-model="sendingData.company_description" validate-type="name" class="input-field " name="job_description"></textarea>
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>

       <div class="form-element clearfix">
        <label for="inputEmail3" class="col-sm-14 pad-zero">Job Requirement Details</label>
        <div class="col-sm-9 pad-zero">
          <span class="form-hold2 clearfix">
            <div class="">
              <textarea type="text" required ng-model="sendingData.job_requirement" validate-type="name" class="input-field " name="job_description"></textarea>
              <div class="input-wrapper"></div>
              <div class="message"></div>
            </div>
          </span>
        </div>
      </div>
    </div>
    <div class="errormessage" ng-show="isError">{{displayError}}</div>
    <div align="center">
      <button type="submit" class="mc-btn" ng-click="submitSearch()">SUBMIT</button>   
    <div>
</form>

<!--  footer  -->
<form name="forgotPasswordForm">
  <div class="modal fade bid-property-modal" id="forgotPasswordModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">Forgot Password</h4>
      </div>
      <div class="modal-body">
          <div class="main-form">

              <!--Expiry Date-->
              <label>Email Address</label>
              <br clear="all">
              <span class="form-hold2 clearfix">
                <div class="validate-line">
                 <input type="email" required class="input-field" name="fname" ng-model="forgotPasswordData.email">
                 <div class="input-wrapper"></div>
                 <div class="message"></div>
                </div>
             </span> <br clear="all">
          <button type="submit" class="mc-btn bid-property-btn" ng-click="forgotPassword()">Submit</button>
      </div>
  </div>
  </div>
  </div>
  </div>
</form>
<!---------------------End footer---------------------> 

<script src="./js/jquery2.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js"></script>
<script src="./js/angular.min.js" type="text/javascript"></script>
<!-- <script src="./js/script.js" type="text/javascript"></script> -->
<script type="text/javascript" src="js/bootstrap-select.js"></script>
<script src=" http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js" type="text/javascript"></script> 
<script type="text/javascript" src="js/pnotify/jquery.pnotify.js"></script> 



<script type="text/javascript">

$('.panel-title a').click(function(e) {
    if ( $(this).parent().parent().next().hasClass('in') ) {
        $(this).text('Show');
    } 
    else {
        $(this).text('Hide');
    }
});
</script>


<script type="text/javascript">
$(window).on('load', function () {

    $('.selectpicker').selectpicker({
    });
    $('.tip').tooltip();	
            // $('.selectpicker').selectpicker('hide');
        });
</script>
<script type="text/javascript">

$('a.accordion-toggle').click(function() {
    if ( $(this).next('.accordion-body').hasClass('show') ) {
        $(this).text('show');
    } else {
        $(this).text('hide');
    }
});


function postJob($scope, $http){

    $scope.dashboardData = {};
    $scope.isLogged = false;
    $scope.isNotLogged = false;

    jQuery('#overlay').removeClass('hide');
    $http({
        method: 'GET',
        url: '/getUserBasicDetails'
    }).success(function (data) {
        jQuery('#overlay').addClass('hide');
        console.log(data);
        jQuery('#overlay').addClass('hide');
        $scope.dashboardData = data.data;
        if (data.status_code == 401 || data.status_code == '401') {
         $scope.isLogged = false;
         $scope.isNotLogged = true;
     } else {
        $scope.isLogged = true;
        $scope.isNotLogged = false;

            // if($scope.dashboardData.is_borrower == true) {
            //     $scope.dashboardUrl = "#RegistrationPending";
            //     sharedProperties.setProperty('usertype','borrower');
            //     sharedProperties.setProperty('userstatus',$scope.dashboardData.status)
            //     if($scope.dashboardData.status == 'unverified') {
            //         window.location.href = "/dashboard.html#/RegistrationPending";
            //     }
            // } else {
            //     $scope.dashboardUrl = "#oneStepRegistration";
            //     sharedProperties.setProperty('usertype','investor');
            // }
            // console.log($scope.dashboardData.email);
            // jQuery('#userEmailFromRequest').val($scope.dashboardData.email);
            // jQuery('#userEmailId').val($scope.dashboardData.email);
        }
    });



var sendingData = {
  'job_type' : "",
  'job_industry' : "",
  'job_description' : "",
  'job_designation' : "",
  'min_exp_level' : "",
  'max_exp_level' : "",
  'min_salary_range' : "",
  'max_salary_range' : "",
  'company_name' : "",
  'company_logo' : "",
  'link_to_compnay' : "",
  'company_description' : "",
  'job_requirement' : ""
};
//console.log(sendingData);
$scope.submitSearch = function(){
    console.log($scope.sendingData);
    $http({
      method  : 'POST',
      url     : 'postJob',
      data    : $scope.sendingData  // pass in data as strings
  }).success(function(data) {
       jQuery('#overlay').addClass('hide');
       $scope.loading = false;
       if(data.status_code == 200 || data.status_code =="200" ){
           $scope.successMessage = data.data.Reason;
           jQuery.pnotify({
              text: $scope.successMessage,
              type: 'success'
          });
           jQuery('#forgotPasswordModal').modal('hide');
       } else {
           $scope.errorMessage = data.data.Reason;
           jQuery.pnotify({
              text: $scope.errorMessage,
              type: 'error'
          });
       }
  });
}

$scope.forgotPasswordData = {
    "email" : ""
};

$scope.forgotPassword = function() {
    if(!$scope['forgotPasswordForm'].$valid) {
        jQuery.pnotify({
          text: "Invalid form",
          type: 'error'
      });
        return;
    }
    jQuery('#overlay').removeClass('hide');
    $http({
        method : 'POST',
        url : 'password/reset',
        data: $scope.forgotPasswordData
    }).success(function(data) {
       jQuery('#overlay').addClass('hide');
       $scope.loading = false;
       if(data.status_code == 200 || data.status_code =="200" ){
           $scope.successMessage = data.data.Reason;
           jQuery.pnotify({
              text: $scope.successMessage,
              type: 'success'
          });
           jQuery('#forgotPasswordModal').modal('hide');
       } else {
           $scope.errorMessage = data.data.Reason;
           jQuery.pnotify({
              text: $scope.errorMessage,
              type: 'error'
          });
       }  

   });
}
$scope.submitSignIn = function(){
    $( "#sign-in-form .input-field" ).trigger('input').trigger('change').trigger('keydown').blur();
    console.log($scope['signInForm'].$valid);
    console.log($scope.signInData);
    if(!$scope['signInForm'].$valid) {
     console.log('invalid form');
     return;
 }else{
  console.log('valid form');
  jQuery('#overlay').removeClass('hide');
  $http({
    method  : 'POST',
    url     : 'login',
                    data    : $scope.signInData  // pass in data as strings
                }).success(function(data) {
                  console.log(data);
                  jQuery('#overlay').addClass('hide');
                  if(data.status_code!=200){
                      $scope.isError = true;
                      $scope.displayError = data.data.Reason;
                      console.log($scope.displayError)
                      jQuery.pnotify({
                          text: $scope.displayError,
                          type: 'error'
                      });
                  }else{
                    $scope.isError = false;
                    $scope.isBorrower = data.data.is_borrower;
                    if($scope.isBorrower) {
                        window.location.href = "/dashboard.html#/RegistrationPending"
                    } else {
                        window.location.href = "/dashboard.html#/oneStepRegistration"
                    }
                }
            });
            }   
        }

        $scope.logout = function() {
            $http({
                method: 'GET',
                url: '/logout'
            }).success(function(data){
                if (data.status_code == 200 || data.status_code == '200') {
                    window.location.href = "/index.html";
                } else {
                    $scope.isError = true;
                    $scope.displayError = data.data.Reason;
                }
            });
        }
    }

// $('a.accordion-toggle').click(function() {
//     if ( $(this).next('.accordion-body').hasClass('in') ) {
//         $(this).text('Close');
//     } else {
//         $(this).text('Find Cafe');
//     }
// });
</script>
<script type="text/javascript">
jQuery(document).ready(function() {

    $.pnotify.defaults.styling = "jqueryui";
  $("#sign_in_click").on('click',function(){
    $('.sign-in-dropdown').css('display','block');
});

  $(document).mouseup(function (e)
  {
      var container = $(".sign-in-drop");

      if (!container.is(e.target) // if the target of the click isn't the container...
          && container.has(e.target).length === 0) // ... nor a descendant of the container
      {
          jQuery('.sign-in-dropdown').hide();
      }
  });
});

</script>
</body>
</html>
